<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>GoogleDrive | Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Creating a Google Developers Console project and client IDBefore you can integrate Google Sign-In into your website, you must have a Google Developers Console project. In the project, you create a cli">
<meta property="og:type" content="website">
<meta property="og:title" content="GoogleDrive">
<meta property="og:url" content="http://yoursite.com/project/google-drive-file-upload/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="Creating a Google Developers Console project and client IDBefore you can integrate Google Sign-In into your website, you must have a Google Developers Console project. In the project, you create a cli">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 001.png">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 002.png">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 003.png">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 004.png">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 005.png">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 006.png">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 007.png">
<meta property="og:image" content="http://yoursite.com/Google Drive File Upload 008.png">
<meta property="og:updated_time" content="2015-09-02T05:26:05.538Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GoogleDrive">
<meta name="twitter:description" content="Creating a Google Developers Console project and client IDBefore you can integrate Google Sign-In into your website, you must have a Google Developers Console project. In the project, you create a cli">
  
    <link rel="alternative" href="/atom.xml" title="Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="page-undefined" class="article article-type-page" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/project/google-drive-file-upload/index.html" class="article-date">
  <time datetime="2015-01-12T12:10:31.000Z" itemprop="datePublished">2015-01-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      GoogleDrive
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        <div id="toc" class="toc-article">
          <strong class="toc-title">文章目录</strong>
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#creating-a-google-developers-console-project-and-client-id"><span class="toc-number">1.</span> <span class="toc-text">Creating a Google Developers Console project and client ID</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-select-a-project-or-create-a-new-one-by-clicking-create-project"><span class="toc-number">1.1.</span> <span class="toc-text">1. Select a project, or create a new one by clicking Create Project:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-type-into-consent-screen"><span class="toc-number">1.2.</span> <span class="toc-text">2. Type into consent screen.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-create-client-id"><span class="toc-number">1.3.</span> <span class="toc-text">3. Create Client ID</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#quickstart-run-a-drive-app-in-javascript"><span class="toc-number">2.</span> <span class="toc-text">Quickstart: Run a Drive app in JavaScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step-1-enable-the-drive-api"><span class="toc-number">2.1.</span> <span class="toc-text">Step 1: Enable the Drive API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step-2-set-up-the-sample"><span class="toc-number">2.2.</span> <span class="toc-text">Step 2: Set up the sample</span></a></li></ol></li></ol>
        </div>
        <p><br></p>
<h2 id="creating-a-google-developers-console-project-and-client-id">Creating a Google Developers Console project and client ID</h2><p>Before you can integrate Google Sign-In into your website, you must have a Google Developers Console project. In the project, you create a client ID, which you need to call the sign-in API.</p>
<p>To create a Google Developers Console project and client ID, follow these steps:</p>
<h3 id="1-select-a-project-or-create-a-new-one-by-clicking-create-project">1. Select a project, or create a new one by clicking Create Project:</h3><p>Go to the [Google Developers Console]&#xFF08;<a href="https://console.developers.google.com" target="_blank" rel="external">https://console.developers.google.com</a>). </p>
<p><img src="Google Drive File Upload 001.png" alt="Enable Google APIs for use in your apps" title="Enable Google APIs for use in your apps"></p>
<p>Type in a name for your project</p>
<p><img src="Google Drive File Upload 002.png" alt="Type in a name for your project" title="Type in a name for your project"></p>
<h3 id="2-type-into-consent-screen">2. Type into consent screen.</h3><p>a. In the sidebar under &#x201C;APIs &amp; auth&#x201D;, select Consent screen.</p>
<p>b. Choose an Email Address and specify a Product Name.</p>
<p><img src="Google Drive File Upload 003.png" alt="Full into consent screen" title="Full into consent screen"></p>
<h3 id="3-create-client-id">3. Create Client ID</h3><p>a. Click Create a new Client ID &#x2014; a dialog box appears.</p>
<p>b. In the sidebar under &#x201C;APIs &amp; auth&#x201D;, select Credentials.</p>
<p><img src="Google Drive File Upload 004.png" alt="Create new Client ID" title="Create new Client ID"></p>
<p>c. In the Application type section of the dialog, select Web application.</p>
<p>d. In the Authorized JavaScript origins field, enter the origin for your app. You can enter multiple origins to allow for your app to run on different protocols, domains, or subdomains. Wildcards are not allowed. In the example below, the second URL could be a production URL.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">http:</span><span class="comment">//localhost:8080</span></span><br><span class="line"><span class="string">https:</span><span class="comment">//myproductionurl.example.com</span></span><br></pre></td></tr></table></figure>
<p>e. In the Authorized redirect URI field, delete the default value. Redirect URIs are not used with JavaScript APIs.</p>
<p>f. Click the Create Client ID button.</p>
<p><img src="Google Drive File Upload 005.png" alt="Edit Client ID" title="Edit Client ID"></p>
<p>g. Get Client ID.</p>
<p><img src="Google Drive File Upload 006.png" alt="Get Client ID" title="Get Client ID"></p>
<p><br></p>
<h2 id="quickstart-run-a-drive-app-in-javascript">Quickstart: Run a Drive app in JavaScript</h2><p><br></p>
<h3 id="step-1-enable-the-drive-api">Step 1: Enable the Drive API</h3><p>a. In the sidebar under &#x201C;APIs &amp; auth&#x201D;, select API.</p>
<p><img src="Google Drive File Upload 007.png" alt="Enable Drive API" title="Enable Drive API"></p>
<p>b. Click Enable API</p>
<p><img src="Google Drive File Upload 008.png" alt="Enable Drive API" title="Enable Drive API"></p>
<p>Copy the following source code to a file name quickstart.html. In the location marked <your_client_id>, add the Client ID you created in the &#x201C;Enable the Drive API&#x201D; step.</your_client_id></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Note: The AUTHORIZED JAVASCRIPT ORIGINS field must be <span class="operator"><span class="keyword">set</span> <span class="keyword">to</span> the URI <span class="keyword">of</span> the <span class="keyword">domain</span> you host the <span class="keyword">sample</span> <span class="keyword">on</span>. <span class="keyword">For</span> example, <span class="keyword">http</span>://localhost <span class="keyword">if</span> you <span class="keyword">are</span> running the <span class="keyword">sample</span> <span class="keyword">from</span> a <span class="keyword">local</span> webserver.</span></span><br></pre></td></tr></table></figure>
<h3 id="step-2-set-up-the-sample">Step 2: Set up the sample</h3><p>Copy the following source code to a file name quickstart.html. In the location marked <your_client_id>, add the Client ID you created in the &#x201C;Enable the Drive API&#x201D; step.</your_client_id></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;
  &lt;head&gt;
    &lt;meta http-equiv=&quot;Content-type&quot; content=&quot;text/html;charset=UTF-8&quot;&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      var CLIENT_ID = &apos;&lt;YOUR_CLIENT_ID&gt;&apos;;
      var SCOPES = &apos;https://www.googleapis.com/auth/drive&apos;;

      /**
       * Called when the client library is loaded to start the auth flow.
       */
      function handleClientLoad() {
        window.setTimeout(checkAuth, 1);
      }

      /**
       * Check if the current user has authorized the application.
       */
      function checkAuth() {
        gapi.auth.authorize(
            {&apos;client_id&apos;: CLIENT_ID, &apos;scope&apos;: SCOPES, &apos;immediate&apos;: true},
            handleAuthResult);
      }

      /**
       * Called when authorization server replies.
       *
       * @param {Object} authResult Authorization result.
       */
      function handleAuthResult(authResult) {
        var authButton = document.getElementById(&apos;authorizeButton&apos;);
        var filePicker = document.getElementById(&apos;filePicker&apos;);
        authButton.style.display = &apos;none&apos;;
        filePicker.style.display = &apos;none&apos;;
        if (authResult &amp;&amp; !authResult.error) {
          // Access token has been successfully retrieved, requests can be sent to the API.
          filePicker.style.display = &apos;block&apos;;
          filePicker.onchange = uploadFile;
        } else {
          // No access token could be retrieved, show the button to start the authorization flow.
          authButton.style.display = &apos;block&apos;;
          authButton.onclick = function() {
              gapi.auth.authorize(
                  {&apos;client_id&apos;: CLIENT_ID, &apos;scope&apos;: SCOPES, &apos;immediate&apos;: false},
                  handleAuthResult);
          };
        }
      }

      /**
       * Start the file upload.
       *
       * @param {Object} evt Arguments from the file selector.
       */
      function uploadFile(evt) {
        gapi.client.load(&apos;drive&apos;, &apos;v2&apos;, function() {
          var file = evt.target.files[0];
          insertFile(file);
        });
      }

      /**
       * Insert new file.
       *
       * @param {File} fileData File object to read data from.
       * @param {Function} callback Function to call when the request is complete.
       */
      function insertFile(fileData, callback) {
        const boundary = &apos;-------314159265358979323846&apos;;
        const delimiter = &quot;\r\n--&quot; + boundary + &quot;\r\n&quot;;
        const close_delim = &quot;\r\n--&quot; + boundary + &quot;--&quot;;

        var reader = new FileReader();
        reader.readAsBinaryString(fileData);
        reader.onload = function(e) {
          var contentType = fileData.type || &apos;application/octet-stream&apos;;
          var metadata = {
            &apos;title&apos;: fileData.name,
            &apos;mimeType&apos;: contentType
          };

          var base64Data = btoa(reader.result);
          var multipartRequestBody =
              delimiter +
              &apos;Content-Type: application/json\r\n\r\n&apos; +
              JSON.stringify(metadata) +
              delimiter +
              &apos;Content-Type: &apos; + contentType + &apos;\r\n&apos; +
              &apos;Content-Transfer-Encoding: base64\r\n&apos; +
              &apos;\r\n&apos; +
              base64Data +
              close_delim;

          var request = gapi.client.request({
              &apos;path&apos;: &apos;/upload/drive/v2/files&apos;,
              &apos;method&apos;: &apos;POST&apos;,
              &apos;params&apos;: {&apos;uploadType&apos;: &apos;multipart&apos;},
              &apos;headers&apos;: {
                &apos;Content-Type&apos;: &apos;multipart/mixed; boundary=&quot;&apos; + boundary + &apos;&quot;&apos;
              },
              &apos;body&apos;: multipartRequestBody});
          if (!callback) {
            callback = function(file) {
              console.log(file)
            };
          }
          request.execute(callback);
        }
      }
    &lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;https://apis.google.com/js/client.js?onload=handleClientLoad&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;!--Add a file picker for the user to start the upload process --&gt;
    &lt;input type=&quot;file&quot; id=&quot;filePicker&quot; style=&quot;display: none&quot; /&gt;
    &lt;input type=&quot;button&quot; id=&quot;authorizeButton&quot; style=&quot;display: none&quot; value=&quot;Authorize&quot; /&gt;
  &lt;/body&gt;
&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>Reference:</p>
<p><a href="https://developers.google.com/identity/sign-in/web/devconsole-project" target="_blank" rel="external">Creating a Google Developers Console project and client ID</a></p>
<p><a href="https://developers.google.com/identity/sign-in/web/sign-in" target="_blank" rel="external">Integrating Google Sign-In into your web app</a></p>
<p><a href="https://developers.google.com/identity/sign-in/web/people" target="_blank" rel="external">Getting profile information</a></p>
<p><a href="https://developers.google.com/identity/sign-in/web/backend-auth" target="_blank" rel="external">Authenticate with a backend server</a></p>
<p><a href="https://developers.google.com/drive/web/quickstart/quickstart-js" target="_blank" rel="external">Quickstart: Run a Drive app in JavaScript</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/project/google-drive-file-upload/index.html" data-id="cie2euml30003msa5uvw6cnnu" class="article-share-link">Share</a>
      
        <a href="http://yoursite.com/project/google-drive-file-upload/index.html#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
    
  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloud/">cloud</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/09/02/使用客户端API上传文件到GoogleDrive/">使用客户端API上传文件到GoogleDrive</a>
          </li>
        
          <li>
            <a href="/2015/09/02/使用hexo建立博客/">使用hexo建立博客</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 hork,lim<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'haolin2015';
  
  var disqus_url = 'http://yoursite.com/project/google-drive-file-upload/index.html';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>